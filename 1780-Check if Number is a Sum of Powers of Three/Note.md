# 1780. Check if Number is a Sum of Powers of Three

Given an integer `n`, return `true` if it is possible to represent `n` as 
the sum of distinct powers of three. Otherwise, return `false`.

An integer `y` is a power of three if there exists an integer `x` such that `y == 3x`.

**Constraints:**

- `1 <= n <= 10^7`

## 基礎思路

這題利用數學的方法可以證明，只要對持續對 `n` 進行除法，並檢查餘數數值，
若餘數為 2 則直接返回 `false`，否則將 `n` 除以 3 繼續檢查，直到所有位數都檢查完畢 (得到 `0`) 返回 `true`。

### 數學證明

證明：對任意非負整數 $ n $，存在下述等價關係：

> **定理**：$ n $ 可寫成「不同的 $3$ 的冪次之和」當且僅當 $ n $ 的三進位表示中只包含 $0$ 與 $1$（即不包含 $2$）。

這裡「不同的 $3$ 的冪次之和」指的是存在一組互不相同的非負整數指數 $ i_1, i_2, \dots, i_m $，使得
$$
n = 3^{i_1} + 3^{i_2} + \cdots + 3^{i_m}.
$$

下面分「必要性」與「充分性」兩部分進行證明。

#### 1. 三進位唯一表示定理

根據數論中的進位制表示定理，對於任一非負整數 $ n $，存在唯一的一組係數 $ a_0, a_1, \dots, a_k $，滿足

$$
n = a_k3^k + a_{k-1}3^{k-1} + \cdots + a_0,
$$

其中每個 $ a_i \in \{0,1,2\} $，且最高位 $ a_k \neq 0 $。這是利用歐幾里得除法反覆進行而得的唯一表示。

#### 2. 必要性證明

1. 假設 $ n $ 可表示為

   $$
   n = 3^{i_1} + 3^{i_2} + \cdots + 3^{i_m},
   $$

   其中 $ i_1, i_2, \dots, i_m $ 互不相同。  
   這意味著在對應的三進位表示中，每個指數 $ i_j $ 的位置上出現一次數字 $1$，而其他位均為 $0$。

2. 根據三進位表示的唯一性，若一個數可以表示為某些 $3^i$ 的和，則其在第 $ i $ 位上的係數必定正好等於該 $3^i$ 在和中的出現次數。

3. 由於我們在表示 $ n $ 時，每個 $3^{i_j}$ 僅使用一次，所以對任一 $ i $ 位，其係數 $ a_i $ 只能是 $0$ 或 $1$；若存在某一位 $ a_i = 2 $ 意味著 $3^i$ 在和中出現了兩次，這與「各不相同」矛盾。

因此，若 $ n $ 可寫成不同的 $3$ 的冪次之和，則其三進位表示中只可能出現 $0$ 和 $1$，不含 $2$。

#### 3. 充分性證明

1. 設 $ n $ 的三進位表示為

   $$
   n = a_k3^k + a_{k-1}3^{k-1} + \cdots + a_0,
   $$

   且對所有 $ i $，有 $ a_i \in \{0,1\} $（即不含 $2$）。

2. 由於每個 $ a_i $ 僅為 $0$ 或 $1$，我們可以將 $ n $ 改寫為

   $$
   n = \sum_{i=0}^{k} a_i 3^i = \sum_{i \,:\, a_i=1} 3^i.
   $$

   這正是一個由若干個不同的 $3^i$ 相加構成的表示法。

3. 因此，$ n $ 可表示為

   $$
   n = 3^{i_1} + 3^{i_2} + \cdots + 3^{i_m},
   $$

   其中 $ \{i_1, i_2, \dots, i_m\} $ 為所有滿足 $ a_i = 1 $ 的位指數，且這些指數顯然是互不相同的。

因此，若 $ n $ 的三進位表示中不含 $2$，則 $ n $ 能寫成不同 $3$ 的冪次之和。

## 解題步驟

### Step 1: 迴圈檢查

1. 初始化 `n` 為輸入值。
2. 當 `n` 不為 `0` 時，持續進行以下操作：
   - 若 `n` 的餘數為 `2`，則返回 `false`。
   - 將 `n` 除以 `3`，並將結果重新賦值給 `n`。

```typescript
while (n > 0) {
  if (n % 3 === 2) {
    // 若 n 的餘數為 2，則直接返回 false
    return false;
  }
  
  // 將 n 除以 3
  // Note Math.floor(1 / 3) = 0, Math.floor(2 / 3) = 0, Math.floor(3 / 3) = 1
  n = Math.floor(n / 3);
}
```

## 時間複雜度

- 由於每次對 `n` 進行除法操作，時間複雜度為 $O(\log_3 n)$。
- 總時間複雜度為 $O(\log_3 n)$。

> $O(\log_3 n)$

## 空間複雜度

- 由於只使用了常數個變數，空間複雜度為 $O(1)$。
- 總空間複雜度為 $O(1)$。

> $O(1)$
